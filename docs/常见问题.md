# 常见问题

> 环境提示：预览代码需要部署在服务器下，不然无法异步获取需要导出的数据

> 版本更新提示：如果使用 v1.2 以前的版本，filterExportData 的映射关系有所调整，请注意

> 非Layui环境使用：**需要先加载 jQuery，再加载 layui_exts/excel.min.js，随后使用全局变量 LAY_EXCEL 调用函数**

> 特别注意：**不能直接在IFRAME里边直接调用导出方法，因为浏览器会限制这种导出行为，如有遇到此类情况，可使用 parent.layui.excel.exportExcel() 的方式调用父级页面函数以避免这个问题（父页面需要先加载插件）**

## 提效建议：

> 数据规模：前端导出**纯数据 9列10w** 的数据量需要 **7秒左右**的时间，**30W数据占用1.8G，耗时24秒**，普通电脑**最多能导出50w数据，耗时45秒**，文件大小173M，提示内存超限

- 如果数据量比较大，**并且不涉及样式**，最好直接转换为纯数组+CSV的导出，可以省去 filterExportData 和 组装样式的时间和内存（PS：效率提升不算太大，30W数据能提速2s左右，资源主要消耗在调用 XLSX.js之后）
- 一般 exportExcel 会放在 $.ajax() 等异步调用中，如果有需要在点击后纯前端生成Excel，可以使用 async、setTimeout等方式实现异步导出，否则会阻塞主进程。